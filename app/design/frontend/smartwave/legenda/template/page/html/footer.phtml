<?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magentocommerce.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2013 Magento Inc. (http://www.magentocommerce.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?>
<?php 
    $store = Mage::app()->getStore();
    $code  = $store->getCode();
    $footer = Mage::getStoreConfig('legenda_setting/footer_settings', $code);
?>
<div class="footer-container">
    <div class="footer">    
        
        <a href="<?php echo Mage::getUrl("gourmetbox/ajax/index") ?>" class="ajax-popup-link">Show inline popup</a>
        
        <?php if($footer['pre_footer_enabled']): ?>
            <?php echo $this->getLayout()->createBlock('cms/block')->setBlockId($footer['pre_footer'])->toHtml();?>
        <?php endif; ?>
        <?php if($footer['footer_top_enabled']): ?>
        <div class="footer-top">
            <div class="container">
                <?php if(Mage::getStoreConfig('legenda_design/footer/footer_top_border', $code)): ?>
                <div class="bordered-wrapper">
                <?php endif; ?>
                    <div class="row">
                    <?php if($footer['footer_top_column_1']): ?>
                        <div class="col-sm-<?php echo $footer['footer_top_column_1_size']?>">
                            <div class="content-element">
                                <?php 
                                    $area = 'footer_top_column_1';
                                    $type = $footer[$area];
                                    if ($type == 'custom') {
                                        echo $this->getLayout()->createBlock('cms/block')->setBlockId($footer[$area.'_custom'])->toHtml();
                                    } else {
                                        echo $this->getChildHtml('footer_'.$footer[$area]);
                                    }
                                 ?>
                             </div>
                        </div>
                    <?php endif; ?>
                    <?php if($footer['footer_top_column_2']): ?>
                        <div class="col-sm-<?php echo $footer['footer_top_column_2_size']?>">
                            <div class="content-element">
                                <?php 
                                    $area = 'footer_top_column_2';
                                    $type = $footer[$area];
                                    if ($type == 'custom') {
                                        echo $this->getLayout()->createBlock('cms/block')->setBlockId($footer[$area.'_custom'])->toHtml();
                                    } else {
                                        echo $this->getChildHtml('footer_'.$footer[$area]);
                                    }
                                 ?>
                             </div>
                        </div>
                    <?php endif; ?>
                    <?php if($footer['footer_top_column_3']): ?>
                        <div class="col-sm-<?php echo $footer['footer_top_column_3_size']?>">
                            <div class="content-element">
                                <?php 
                                    $area = 'footer_top_column_3';
                                    $type = $footer[$area];
                                    if ($type == 'custom') {
                                        echo $this->getLayout()->createBlock('cms/block')->setBlockId($footer[$area.'_custom'])->toHtml();
                                    } else {
                                        echo $this->getChildHtml('footer_'.$footer[$area]);
                                    }
                                 ?>
                             </div>
                        </div>
                    <?php endif; ?>
                    <?php if($footer['footer_top_column_4']): ?>
                        <div class="col-sm-<?php echo $footer['footer_top_column_4_size']?>">
                            <div class="content-element">
                                <?php 
                                    $area = 'footer_top_column_4';
                                    $type = $footer[$area];
                                    if ($type == 'custom') {
                                        echo $this->getLayout()->createBlock('cms/block')->setBlockId($footer[$area.'_custom'])->toHtml();
                                    } else {
                                        echo $this->getChildHtml('footer_'.$footer[$area]);
                                    }
                                 ?>
                             </div>
                        </div>
                    <?php endif; ?>
                    <?php if($footer['footer_top_column_5']): ?>
                        <div class="col-sm-<?php echo $footer['footer_top_column_5_size']?>">
                            <div class="content-element">
                                <?php 
                                    $area = 'footer_top_column_5';
                                    $type = $footer[$area];
                                    if ($type == 'custom') {
                                        echo $this->getLayout()->createBlock('cms/block')->setBlockId($footer[$area.'_custom'])->toHtml();
                                    } else {
                                        echo $this->getChildHtml('footer_'.$footer[$area]);
                                    }
                                 ?>
                             </div>
                        </div>
                    <?php endif; ?>
                </div>
                <?php if(Mage::getStoreConfig('legenda_design/footer/footer_top_border', $code)): ?>
                </div>
                <?php endif; ?>
            </div>
        </div>
        <?php endif; ?>
        <?php if($footer['footer_bottom_enabled']): ?>
        <div class="footer-bottom">
            <div class="container">
                <?php if(Mage::getStoreConfig('legenda_design/footer/footer_bottom_border', $code)): ?>
                <div class="bordered-wrapper">
                <?php endif; ?>
                    <div class="row">
                    <?php if($footer['footer_bottom_column_1']): ?>
                        <div class="col-sm-<?php echo $footer['footer_bottom_column_1_size']?>">
                            <div class="content-element">
                                <?php 
                                    $area = 'footer_bottom_column_1';
                                    $type = $footer[$area];
                                    if ($type == 'custom') {
                                        echo $this->getLayout()->createBlock('cms/block')->setBlockId($footer[$area.'_custom'])->toHtml();
                                    } else {
                                        echo $this->getChildHtml('footer_'.$footer[$area]);
                                    }
                                 ?>
                             </div>
                        </div>
                    <?php endif; ?>
                    <?php if($footer['footer_bottom_column_2']): ?>
                        <div class="col-sm-<?php echo $footer['footer_bottom_column_2_size']?>">
                            <div class="content-element">
                                <?php 
                                    $area = 'footer_bottom_column_2';
                                    $type = $footer[$area];
                                    if ($type == 'custom') {
                                        echo $this->getLayout()->createBlock('cms/block')->setBlockId($footer[$area.'_custom'])->toHtml();
                                    } else {
                                        echo $this->getChildHtml('footer_'.$footer[$area]);
                                    }
                                 ?>
                             </div>
                        </div>
                    <?php endif; ?>
                    <?php if($footer['footer_bottom_column_3']): ?>
                        <div class="col-sm-<?php echo $footer['footer_bottom_column_3_size']?>">
                            <div class="content-element">
                                <?php 
                                    $area = 'footer_bottom_column_3';
                                    $type = $footer[$area];
                                    if ($type == 'custom') {
                                        echo $this->getLayout()->createBlock('cms/block')->setBlockId($footer[$area.'_custom'])->toHtml();
                                    } else {
                                        echo $this->getChildHtml('footer_'.$footer[$area]);
                                    }
                                 ?>
                             </div>
                        </div>
                    <?php endif; ?>
                    <?php if($footer['footer_bottom_column_4']): ?>
                        <div class="col-sm-<?php echo $footer['footer_bottom_column_4_size']?>">
                            <div class="content-element">
                                <?php 
                                    $area = 'footer_bottom_column_4';
                                    $type = $footer[$area];
                                    if ($type == 'custom') {
                                        echo $this->getLayout()->createBlock('cms/block')->setBlockId($footer[$area.'_custom'])->toHtml();
                                    } else {
                                        echo $this->getChildHtml('footer_'.$footer[$area]);
                                    }
                                 ?>
                             </div>
                        </div>
                    <?php endif; ?>
                    <?php if($footer['footer_bottom_column_5']): ?>
                        <div class="col-sm-<?php echo $footer['footer_bottom_column_5_size']?>">
                            <div class="content-element">
                                <?php 
                                    $area = 'footer_bottom_column_5';
                                    $type = $footer[$area];
                                    if ($type == 'custom') {
                                        echo $this->getLayout()->createBlock('cms/block')->setBlockId($footer[$area.'_custom'])->toHtml();
                                    } else {
                                        echo $this->getChildHtml('footer_'.$footer[$area]);
                                    }
                                 ?>
                             </div>
                        </div>
                    <?php endif; ?>
                </div>
                <?php if(Mage::getStoreConfig('legenda_design/footer/footer_bottom_border', $code)): ?>
                </div>
                <?php endif; ?>
            </div>
        </div>
        <?php endif; ?>
        <?php if($footer['copyright_enabled']): ?>
        <div class="copyright">
            <div class="container">
                <?php if(Mage::getStoreConfig('legenda_design/footer/footer_copyright_border', $code)): ?>
                <div class="bordered-wrapper">
                <?php endif; ?>
                    <div class="row">
                        <div class="col-sm-6 text-left">
                            <a href="<?php echo Mage::getBaseUrl(); ?>"><img src="<?php echo Mage::getDesign()->getSkinUrl($footer['copyright_logo']); ?>" class="logo-small"/></a>
                            <img src="/custom/sticker_recyclage_white.png" class="logo-eco"/>
                        </div>
                        <div class="col-sm-6 text-right">							
                            <address><?php echo $footer['copyright_text'] ?></address>
							<?php echo $this->getChildHtml('store_switcher') ?>
                        </div>
                    </div>
                <?php if(Mage::getStoreConfig('legenda_design/footer/footer_copyright_border', $code)): ?>
                </div>
                <?php endif; ?>
            </div>
        </div>
        <?php endif; ?>
    </div>
</div>
<script type="text/javascript">
  var _ae = {
    'pid': '548289d323b944e0498b4f4b',
    'advertiserFirst': 21600, // 15 days in mins
    'allowSiteUnder': false,
    'allowIframing': false,
    'host': 'https://lb.affilae.com'
  };
 
  (function() {
    var element = document.createElement('script'); element.type = 'text/javascript'; element.async = true;
    element.src = '//static.affilae.com/ae-v3.2.js';
    var scr = document.getElementsByTagName('script')[0]; scr.parentNode.insertBefore(element, scr);
  })();
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-53221186-1', 'auto');
  ga('send', 'pageview');

</script>
<script src="/custom/scrolldepth.min.js"></script>
<script>
jQuery(function() {
  jQuery.scrollDepth();
});

<?php
$cmsIdentifier = Mage::getStoreConfig('cms/gourmetbox/popup_general');
if ($cmsIdentifier) :
    $cookieValue = Mage::getModel('core/cookie')->get('popup');
    ?>
    if (readCookie("popup") != '<?php echo $cmsIdentifier; ?>') {
        alert(readCookie("popup"));
        alert('<?php echo $cmsIdentifier; ?>');
        jQuery(document).ready(function() {
            jQuery( ".ajax-popup-link" ).trigger( "click" );
        });

        jQuery( ".ajax-popup-link" ).magnificPopup({
            type: 'ajax'
        });
    }
<?php
endif;
?>

function readCookie(name) {
    var nameEQ = name + "=";
    var ca = document.cookie.split(';');
    for(var i=0;i < ca.length;i++) {
        var c = ca[i];
        while (c.charAt(0)==' ') c = c.substring(1,c.length);
        if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);
    }
    return null;
}

</script>